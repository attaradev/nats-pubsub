<h2>Outbox Event Details</h2>

<div class="card">
  <div class="detail-row">
    <div class="detail-label">Event ID</div>
    <div><%= @event.event_id %></div>
  </div>

  <div class="detail-row">
    <div class="detail-label">Subject</div>
    <div><%= @event.subject %></div>
  </div>

  <div class="detail-row">
    <div class="detail-label">Status</div>
    <div><span class="badge <%= status_badge_class(@event.status) %>"><%= @event.status %></span></div>
  </div>

  <% if @event.respond_to?(:attempts) %>
    <div class="detail-row">
      <div class="detail-label">Attempts</div>
      <div><%= @event.attempts %></div>
    </div>
  <% end %>

  <% if @event.respond_to?(:enqueued_at) %>
    <div class="detail-row">
      <div class="detail-label">Enqueued At</div>
      <div><%= format_time(@event.enqueued_at) %></div>
    </div>
  <% end %>

  <% if @event.respond_to?(:sent_at) %>
    <div class="detail-row">
      <div class="detail-label">Sent At</div>
      <div><%= format_time(@event.sent_at) %></div>
    </div>
  <% end %>

  <div class="detail-row">
    <div class="detail-label">Created At</div>
    <div><%= format_time(@event.created_at) %></div>
  </div>

  <div class="detail-row">
    <div class="detail-label">Updated At</div>
    <div><%= format_time(@event.updated_at) %></div>
  </div>

  <% if @event.respond_to?(:last_error) && @event.last_error %>
    <div class="detail-row">
      <div class="detail-label">Last Error</div>
      <div style="color: #e74c3c;"><%= @event.last_error %></div>
    </div>
  <% end %>

  <h3 style="margin-top: 30px; margin-bottom: 15px;">Payload</h3>
  <pre><%= JSON.pretty_generate(@event.payload) %></pre>

  <% if @event.respond_to?(:headers) && @event.headers %>
    <h3 style="margin-top: 30px; margin-bottom: 15px;">Headers</h3>
    <pre><%= JSON.pretty_generate(@event.headers) %></pre>
  <% end %>

  <div style="margin-top: 30px; display: flex; gap: 10px;">
    <a href="/outbox" class="btn btn-secondary">Back to List</a>
    <% if @event.status == 'failed' %>
      <form method="post" action="/outbox/<%= @event.id %>/retry" style="display: inline;">
        <button type="submit" class="btn btn-primary">Retry</button>
      </form>
    <% end %>
    <form method="post" action="/outbox/<%= @event.id %>" style="display: inline;">
      <input type="hidden" name="_method" value="DELETE">
      <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this event?')">Delete</button>
    </form>
  </div>
</div>
