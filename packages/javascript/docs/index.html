<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>nats-pubsub API Documentation - v0.2.0</title><meta name="description" content="Documentation for nats-pubsub API Documentation"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">nats-pubsub API Documentation - v0.2.0</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>nats-pubsub API Documentation - v0.2.0</h1></div><div class="tsd-panel tsd-typography"><h1 id="natspubsub-nodejstypescript" class="tsd-anchor-link">NatsPubsub (Node.js/TypeScript)<a href="#natspubsub-nodejstypescript" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://www.npmjs.com/package/nats-pubsub"><img src="https://img.shields.io/npm/v/nats-pubsub.svg" alt="npm version"></a>
<a href="https://www.npmjs.com/package/nats-pubsub"><img src="https://img.shields.io/npm/dm/nats-pubsub.svg" alt="npm downloads"></a>
<a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a>
<a href="https://www.typescriptlang.org/"><img src="https://img.shields.io/badge/TypeScript-5.9-blue.svg" alt="TypeScript"></a>
<a href="https://nodejs.org/"><img src="https://img.shields.io/badge/Node.js-20%2B-green.svg" alt="Node.js"></a></p>
<p><strong>Declarative PubSub messaging for NATS JetStream</strong></p>
<p>A production-ready pub/sub library for Node.js/TypeScript with declarative subscribers, middleware support, and battle-tested reliability patterns including DLQ and automatic retries with backoff.</p>
<p>This is the Node.js/TypeScript implementation of NatsPubsub. For the Ruby version, see <a href="media/ruby">../ruby</a>.</p>
<h2 id="üöÄ-quick-start-5-minutes" class="tsd-anchor-link">üöÄ Quick Start (&lt; 5 minutes)<a href="#üöÄ-quick-start-5-minutes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-0">// 1. Install</span><br/><span class="hl-0">// pnpm add nats-pubsub</span><br/><br/><span class="hl-0">// 2. Start NATS Server (in terminal)</span><br/><span class="hl-0">// docker run -d -p 4222:4222 nats:latest -js</span><br/><br/><span class="hl-0">// 3. Configure and Publish</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">configure</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-3">natsUrls:</span><span class="hl-2"> </span><span class="hl-4">&#39;nats://localhost:4222&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">appName:</span><span class="hl-2"> </span><span class="hl-4">&#39;my-app&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">env:</span><span class="hl-2"> </span><span class="hl-4">&#39;development&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">publish</span><span class="hl-2">(</span><span class="hl-4">&#39;notifications.email&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-3">to:</span><span class="hl-2"> </span><span class="hl-4">&#39;user@example.com&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">subject:</span><span class="hl-2"> </span><span class="hl-4">&#39;Welcome!&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 4. Create a Subscriber</span><br/><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">BaseSubscriber</span><span class="hl-2">, </span><span class="hl-3">EventMetadata</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-6">class</span><span class="hl-2"> </span><span class="hl-7">EmailSubscriber</span><span class="hl-2"> </span><span class="hl-6">extends</span><span class="hl-2"> </span><span class="hl-7">BaseSubscriber</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">constructor</span><span class="hl-2">() {</span><br/><span class="hl-2">    </span><span class="hl-6">super</span><span class="hl-2">(</span><span class="hl-4">&#39;development.my-app.notifications.email&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-2">  </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">call</span><span class="hl-2">(</span><span class="hl-3">message</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;, </span><span class="hl-3">metadata</span><span class="hl-2">: </span><span class="hl-7">EventMetadata</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-4">&#39;Sending email:&#39;</span><span class="hl-2">, </span><span class="hl-3">message</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-0">// Your logic here</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// 5. Start Processing</span><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">registerSubscriber</span><span class="hl-2">(</span><span class="hl-6">new</span><span class="hl-2"> </span><span class="hl-5">EmailSubscriber</span><span class="hl-2">());</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">start</span><span class="hl-2">();</span>
</code><button type="button">Copy</button></pre>

<p>That's it! You're now publishing and consuming messages with NATS JetStream.</p>
<h2 id="table-of-contents" class="tsd-anchor-link">Table of Contents<a href="#table-of-contents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="#-quick-start---5-minutes">Quick Start</a></li>
<li><a href="#-features">Features</a></li>
<li><a href="#-install">Installation</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#-configure">Configuration</a></li>
<li><a href="#environment-variables">Environment Variables</a></li>
<li><a href="#-subject-pattern">Subject Pattern</a></li>
<li><a href="#-declarative-subscribers">Declarative Subscribers</a></li>
<li><a href="#-publish-events">Publishing Events</a></li>
<li><a href="#-run-subscribers">Running Subscribers</a></li>
<li><a href="#-middleware">Middleware</a></li>
<li><a href="#-testing">Testing</a></li>
<li><a href="#deployment">Deployment</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#-license">License</a></li>
</ul>
<hr>
<h2 id="‚ú®-features" class="tsd-anchor-link">‚ú® Features<a href="#‚ú®-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>üéØ <strong>Declarative API</strong> - Familiar pattern for defining subscribers</li>
<li>üîå <strong>Simple Publishing</strong> - <code>NatsPubsub.publish(domain, resource, action, payload)</code></li>
<li>üß® <strong>DLQ</strong> for poison messages</li>
<li>‚öôÔ∏è Durable <code>pull_subscribe</code> with backoff &amp; <code>max_deliver</code></li>
<li>üé≠ <strong>Middleware system</strong> - Extensible processing pipeline</li>
<li>üöÄ <strong>TypeScript first</strong> - Full type safety and IntelliSense support</li>
<li>üß± <strong>Overlap-safe stream provisioning</strong> - Prevents &quot;subjects overlap&quot; errors</li>
<li>üìä Configurable logging with sensible defaults</li>
</ul>
<hr>
<h2 id="üì¶-install" class="tsd-anchor-link">üì¶ Install<a href="#üì¶-install" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-5">pnpm</span><span class="hl-2"> </span><span class="hl-4">add</span><span class="hl-2"> </span><span class="hl-4">nats-pubsub</span><br/><span class="hl-0"># or</span><br/><span class="hl-5">npm</span><span class="hl-2"> </span><span class="hl-4">install</span><span class="hl-2"> </span><span class="hl-4">nats-pubsub</span><br/><span class="hl-0"># or</span><br/><span class="hl-5">yarn</span><span class="hl-2"> </span><span class="hl-4">add</span><span class="hl-2"> </span><span class="hl-4">nats-pubsub</span>
</code><button type="button">Copy</button></pre>

<h3 id="prerequisites" class="tsd-anchor-link">Prerequisites<a href="#prerequisites" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>Node.js 24+</li>
<li>NATS Server with JetStream enabled</li>
<li>pnpm 10+ (recommended) or npm/yarn</li>
</ul>
<h3 id="start-nats-server" class="tsd-anchor-link">Start NATS Server<a href="#start-nats-server" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0"># macOS</span><br/><span class="hl-5">brew</span><span class="hl-2"> </span><span class="hl-4">install</span><span class="hl-2"> </span><span class="hl-4">nats-server</span><br/><span class="hl-5">nats-server</span><span class="hl-2"> </span><span class="hl-6">-js</span><br/><br/><span class="hl-0"># Linux</span><br/><span class="hl-5">curl</span><span class="hl-2"> </span><span class="hl-6">-L</span><span class="hl-2"> </span><span class="hl-4">https://github.com/nats-io/nats-server/releases/download/v2.10.0/nats-server-v2.10.0-linux-amd64.zip</span><span class="hl-2"> </span><span class="hl-6">-o</span><span class="hl-2"> </span><span class="hl-4">nats-server.zip</span><br/><span class="hl-5">unzip</span><span class="hl-2"> </span><span class="hl-4">nats-server.zip</span><br/><span class="hl-5">sudo</span><span class="hl-2"> </span><span class="hl-4">mv</span><span class="hl-2"> </span><span class="hl-4">nats-server-v2.10.0-linux-amd64/nats-server</span><span class="hl-2"> </span><span class="hl-4">/usr/local/bin/</span><br/><span class="hl-5">nats-server</span><span class="hl-2"> </span><span class="hl-6">-js</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üîß-configure" class="tsd-anchor-link">üîß Configure<a href="#üîß-configure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">configure</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-3">natsUrls:</span><span class="hl-2"> </span><span class="hl-3">process</span><span class="hl-2">.</span><span class="hl-3">env</span><span class="hl-2">.</span><span class="hl-8">NATS_URLS</span><span class="hl-2"> || </span><span class="hl-4">&#39;nats://localhost:4222&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">env:</span><span class="hl-2"> </span><span class="hl-3">process</span><span class="hl-2">.</span><span class="hl-3">env</span><span class="hl-2">.</span><span class="hl-8">NODE_ENV</span><span class="hl-2"> || </span><span class="hl-4">&#39;development&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">appName:</span><span class="hl-2"> </span><span class="hl-3">process</span><span class="hl-2">.</span><span class="hl-3">env</span><span class="hl-2">.</span><span class="hl-8">APP_NAME</span><span class="hl-2"> || </span><span class="hl-4">&#39;app&#39;</span><span class="hl-2">,</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Consumer tuning</span><br/><span class="hl-2">  </span><span class="hl-3">concurrency:</span><span class="hl-2"> </span><span class="hl-9">10</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">maxDeliver:</span><span class="hl-2"> </span><span class="hl-9">5</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">ackWait:</span><span class="hl-2"> </span><span class="hl-9">30000</span><span class="hl-2">, </span><span class="hl-0">// 30 seconds in ms</span><br/><span class="hl-2">  </span><span class="hl-3">backoff:</span><span class="hl-2"> [</span><span class="hl-9">1000</span><span class="hl-2">, </span><span class="hl-9">5000</span><span class="hl-2">, </span><span class="hl-9">15000</span><span class="hl-2">, </span><span class="hl-9">30000</span><span class="hl-2">, </span><span class="hl-9">60000</span><span class="hl-2">], </span><span class="hl-0">// in ms</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Features</span><br/><span class="hl-2">  </span><span class="hl-3">useDlq:</span><span class="hl-2"> </span><span class="hl-6">true</span><span class="hl-2">,</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Custom logger (optional)</span><br/><span class="hl-2">  </span><span class="hl-3">logger:</span><span class="hl-2"> </span><span class="hl-3">customLogger</span><span class="hl-2">,</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="environment-variables" class="tsd-anchor-link">Environment Variables<a href="#environment-variables" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Copy <code>.env.example</code> to <code>.env</code> and configure:</p>
<pre><code class="bash"><span class="hl-5">cp</span><span class="hl-2"> </span><span class="hl-4">.env.example</span><span class="hl-2"> </span><span class="hl-4">.env</span>
</code><button type="button">Copy</button></pre>

<p><strong>Required Variables:</strong></p>
<ul>
<li><code>NATS_URLS</code> - NATS server URLs (comma-separated for clusters)</li>
<li><code>NODE_ENV</code> - Environment (development/production)</li>
<li><code>APP_NAME</code> - Application name for event producer identification</li>
</ul>
<p><strong>Optional Variables:</strong></p>
<ul>
<li><code>CONCURRENCY</code> - Number of concurrent message processors (default: 10)</li>
<li><code>MAX_DELIVER</code> - Maximum delivery attempts before DLQ (default: 5)</li>
<li><code>ACK_WAIT</code> - Acknowledgment timeout in milliseconds (default: 30000)</li>
<li><code>USE_DLQ</code> - Enable Dead Letter Queue (default: true)</li>
<li><code>LOG_LEVEL</code> - Logging level (default: info)</li>
</ul>
<hr>
<h2 id="üì°-subject-patterns" class="tsd-anchor-link">üì° Subject Patterns<a href="#üì°-subject-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>NatsPubsub supports two subject patterns:</p>
<h3 id="topic-based-pattern" class="tsd-anchor-link">Topic-Based Pattern<a href="#topic-based-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="md">{env}.{appName}.{topic}
</code><button type="button">Copy</button></pre>

<p><strong>Examples:</strong></p>
<ul>
<li><code>production.myapp.notifications.email</code></li>
<li><code>production.myapp.user.created</code></li>
</ul>
<h3 id="domainresourceaction-pattern" class="tsd-anchor-link">Domain/Resource/Action Pattern<a href="#domainresourceaction-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="md">{env}.events.{domain}.{resource}.{action}
</code><button type="button">Copy</button></pre>

<p><strong>Examples:</strong></p>
<ul>
<li><code>production.events.users.user.created</code></li>
<li><code>production.events.orders.order.placed</code></li>
<li><code>staging.events.payments.payment.completed</code></li>
</ul>
<hr>
<h2 id="üéØ-declarative-subscribers" class="tsd-anchor-link">üéØ Declarative Subscribers<a href="#üéØ-declarative-subscribers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="using-class-based-approach" class="tsd-anchor-link">Using Class-based Approach<a href="#using-class-based-approach" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">BaseSubscriber</span><span class="hl-2">, </span><span class="hl-3">EventMetadata</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-6">class</span><span class="hl-2"> </span><span class="hl-7">UserActivitySubscriber</span><span class="hl-2"> </span><span class="hl-6">extends</span><span class="hl-2"> </span><span class="hl-7">BaseSubscriber</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">constructor</span><span class="hl-2">() {</span><br/><span class="hl-2">    </span><span class="hl-6">super</span><span class="hl-2">(</span><span class="hl-4">&#39;production.events.users.user.*&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">      </span><span class="hl-3">retry:</span><span class="hl-2"> </span><span class="hl-9">3</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-3">ackWait:</span><span class="hl-2"> </span><span class="hl-9">60000</span><span class="hl-2">,</span><br/><span class="hl-2">    });</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-2">  </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">call</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;, </span><span class="hl-3">metadata</span><span class="hl-2">: </span><span class="hl-7">EventMetadata</span><span class="hl-2">): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-4">`User </span><span class="hl-6">${</span><span class="hl-3">metadata</span><span class="hl-10">.</span><span class="hl-3">action</span><span class="hl-6">}</span><span class="hl-4">: </span><span class="hl-6">${</span><span class="hl-3">event</span><span class="hl-10">.</span><span class="hl-3">name</span><span class="hl-6">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-0">// Your idempotent domain logic here</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// Register the subscriber</span><br/><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">subscriber</span><span class="hl-2"> = </span><span class="hl-6">new</span><span class="hl-2"> </span><span class="hl-5">UserActivitySubscriber</span><span class="hl-2">();</span><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">registerSubscriber</span><span class="hl-2">(</span><span class="hl-3">subscriber</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="using-decorator-experimental" class="tsd-anchor-link">Using Decorator (experimental)<a href="#using-decorator-experimental" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">subscriber</span><span class="hl-2">, </span><span class="hl-3">EventMetadata</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-2">@</span><span class="hl-5">subscriber</span><span class="hl-2">(</span><span class="hl-4">&#39;production.events.users.user.*&#39;</span><span class="hl-2">, { </span><span class="hl-3">retry:</span><span class="hl-2"> </span><span class="hl-9">3</span><span class="hl-2"> })</span><br/><span class="hl-6">class</span><span class="hl-2"> </span><span class="hl-7">UserActivitySubscriber</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">call</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;, </span><span class="hl-3">metadata</span><span class="hl-2">: </span><span class="hl-7">EventMetadata</span><span class="hl-2">): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-4">`User </span><span class="hl-6">${</span><span class="hl-3">metadata</span><span class="hl-10">.</span><span class="hl-3">action</span><span class="hl-6">}</span><span class="hl-4">: </span><span class="hl-6">${</span><span class="hl-3">event</span><span class="hl-10">.</span><span class="hl-3">name</span><span class="hl-6">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="multiple-subjects" class="tsd-anchor-link">Multiple Subjects<a href="#multiple-subjects" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">class</span><span class="hl-2"> </span><span class="hl-7">EmailNotificationSubscriber</span><span class="hl-2"> </span><span class="hl-6">extends</span><span class="hl-2"> </span><span class="hl-7">BaseSubscriber</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">constructor</span><span class="hl-2">() {</span><br/><span class="hl-2">    </span><span class="hl-6">super</span><span class="hl-2">([</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;production.events.users.user.created&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;production.events.orders.order.placed&#39;</span><br/><span class="hl-2">    ]);</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-2">  </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">call</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;, </span><span class="hl-3">metadata</span><span class="hl-2">: </span><span class="hl-7">EventMetadata</span><span class="hl-2">): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-1">if</span><span class="hl-2"> (</span><span class="hl-3">metadata</span><span class="hl-2">.</span><span class="hl-3">subject</span><span class="hl-2">.</span><span class="hl-5">includes</span><span class="hl-2">(</span><span class="hl-4">&#39;users.user.created&#39;</span><span class="hl-2">)) {</span><br/><span class="hl-2">      </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-5">sendWelcomeEmail</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">);</span><br/><span class="hl-2">    } </span><span class="hl-1">else</span><span class="hl-2"> </span><span class="hl-1">if</span><span class="hl-2"> (</span><span class="hl-3">metadata</span><span class="hl-2">.</span><span class="hl-3">subject</span><span class="hl-2">.</span><span class="hl-5">includes</span><span class="hl-2">(</span><span class="hl-4">&#39;orders.order.placed&#39;</span><span class="hl-2">)) {</span><br/><span class="hl-2">      </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-5">sendOrderConfirmation</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">);</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-2">  </span><span class="hl-6">private</span><span class="hl-2"> </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">sendWelcomeEmail</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-0">// Implementation</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-2">  </span><span class="hl-6">private</span><span class="hl-2"> </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">sendOrderConfirmation</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-0">// Implementation</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üì§-publish-events" class="tsd-anchor-link">üì§ Publish Events<a href="#üì§-publish-events" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>NatsPubsub provides a single polymorphic <code>publish()</code> method that handles all publishing patterns:</p>
<h3 id="topic-based-publishing" class="tsd-anchor-link">Topic-Based Publishing<a href="#topic-based-publishing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Publish to a single topic</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">publish</span><span class="hl-2">(</span><span class="hl-4">&#39;notifications.email&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-3">to:</span><span class="hl-2"> </span><span class="hl-4">&#39;user@example.com&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">subject:</span><span class="hl-2"> </span><span class="hl-4">&#39;Welcome!&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">body:</span><span class="hl-2"> </span><span class="hl-4">&#39;Thank you for signing up&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Publish to multiple topics</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">publish</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-3">topics:</span><span class="hl-2"> [</span><span class="hl-4">&#39;notifications&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;audit&#39;</span><span class="hl-2">],</span><br/><span class="hl-2">  </span><span class="hl-3">message:</span><span class="hl-2"> { </span><span class="hl-3">action:</span><span class="hl-2"> </span><span class="hl-4">&#39;login&#39;</span><span class="hl-2">, </span><span class="hl-3">user_id:</span><span class="hl-2"> </span><span class="hl-9">123</span><span class="hl-2"> }</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="domainresourceaction-publishing" class="tsd-anchor-link">Domain/Resource/Action Publishing<a href="#domainresourceaction-publishing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Using domain/resource/action pattern</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">publish</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-3">domain:</span><span class="hl-2"> </span><span class="hl-4">&#39;users&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">resource:</span><span class="hl-2"> </span><span class="hl-4">&#39;user&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">action:</span><span class="hl-2"> </span><span class="hl-4">&#39;created&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">payload:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-3">id:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">id</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">name:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">name</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">email:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">email</span><span class="hl-2">,</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="with-options" class="tsd-anchor-link">With Options<a href="#with-options" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Topic with options</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">publish</span><span class="hl-2">(</span><span class="hl-4">&#39;notifications.email&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  { </span><span class="hl-3">to:</span><span class="hl-2"> </span><span class="hl-4">&#39;user@example.com&#39;</span><span class="hl-2">, </span><span class="hl-3">body:</span><span class="hl-2"> </span><span class="hl-4">&#39;Hello&#39;</span><span class="hl-2"> },</span><br/><span class="hl-2">  { </span><span class="hl-3">trace_id:</span><span class="hl-2"> </span><span class="hl-4">&#39;trace-123&#39;</span><span class="hl-2">, </span><span class="hl-3">event_id:</span><span class="hl-2"> </span><span class="hl-4">&#39;evt-456&#39;</span><span class="hl-2"> }</span><br/><span class="hl-2">);</span><br/><br/><span class="hl-0">// Domain/Resource/Action with options</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">publish</span><span class="hl-2">(</span><br/><span class="hl-2">  {</span><br/><span class="hl-2">    </span><span class="hl-3">domain:</span><span class="hl-2"> </span><span class="hl-4">&#39;users&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">resource:</span><span class="hl-2"> </span><span class="hl-4">&#39;user&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">action:</span><span class="hl-2"> </span><span class="hl-4">&#39;created&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">payload:</span><span class="hl-2"> { </span><span class="hl-3">id:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">id</span><span class="hl-2">, </span><span class="hl-3">name:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">name</span><span class="hl-2"> },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  {</span><br/><span class="hl-2">    </span><span class="hl-3">event_id:</span><span class="hl-2"> </span><span class="hl-4">&#39;uuid-or-ulid&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">trace_id:</span><span class="hl-2"> </span><span class="hl-4">&#39;hex&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">occurred_at:</span><span class="hl-2"> </span><span class="hl-6">new</span><span class="hl-2"> </span><span class="hl-5">Date</span><span class="hl-2">(),</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üöÄ-run-subscribers" class="tsd-anchor-link">üöÄ Run Subscribers<a href="#üöÄ-run-subscribers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">, { </span><span class="hl-3">loggingMiddleware</span><span class="hl-2">, </span><span class="hl-3">retryLoggerMiddleware</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Configure</span><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">configure</span><span class="hl-2">({ </span><span class="hl-0">/* ... */</span><span class="hl-2"> });</span><br/><br/><span class="hl-0">// Add middleware</span><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">use</span><span class="hl-2">(</span><span class="hl-3">loggingMiddleware</span><span class="hl-2">);</span><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">use</span><span class="hl-2">(</span><span class="hl-3">retryLoggerMiddleware</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Register subscribers</span><br/><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">userSubscriber</span><span class="hl-2"> = </span><span class="hl-6">new</span><span class="hl-2"> </span><span class="hl-5">UserActivitySubscriber</span><span class="hl-2">();</span><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">registerSubscriber</span><span class="hl-2">(</span><span class="hl-3">userSubscriber</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Start consuming</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">start</span><span class="hl-2">();</span><br/><br/><span class="hl-0">// Graceful shutdown</span><br/><span class="hl-3">process</span><span class="hl-2">.</span><span class="hl-5">on</span><span class="hl-2">(</span><span class="hl-4">&#39;SIGTERM&#39;</span><span class="hl-2">, </span><span class="hl-6">async</span><span class="hl-2"> () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">stop</span><span class="hl-2">();</span><br/><span class="hl-2">  </span><span class="hl-3">process</span><span class="hl-2">.</span><span class="hl-5">exit</span><span class="hl-2">(</span><span class="hl-9">0</span><span class="hl-2">);</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üé≠-middleware" class="tsd-anchor-link">üé≠ Middleware<a href="#üé≠-middleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Build a processing pipeline with middleware:</p>
<pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> { </span><span class="hl-3">Middleware</span><span class="hl-2">, </span><span class="hl-3">EventMetadata</span><span class="hl-2"> } </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-6">class</span><span class="hl-2"> </span><span class="hl-7">CustomMiddleware</span><span class="hl-2"> </span><span class="hl-6">implements</span><span class="hl-2"> </span><span class="hl-7">Middleware</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">call</span><span class="hl-2">(</span><br/><span class="hl-2">    </span><span class="hl-3">event</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;,</span><br/><span class="hl-2">    </span><span class="hl-3">metadata</span><span class="hl-2">: </span><span class="hl-7">EventMetadata</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-5">next</span><span class="hl-2">: () </span><span class="hl-6">=&gt;</span><span class="hl-2"> </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt;</span><br/><span class="hl-2">  ): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-4">&#39;Before processing&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">next</span><span class="hl-2">();</span><br/><span class="hl-2">    </span><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-5">log</span><span class="hl-2">(</span><span class="hl-4">&#39;After processing&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">use</span><span class="hl-2">(</span><span class="hl-6">new</span><span class="hl-2"> </span><span class="hl-5">CustomMiddleware</span><span class="hl-2">());</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üì¨-envelope-format" class="tsd-anchor-link">üì¨ Envelope Format<a href="#üì¨-envelope-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="json"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;event_id&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;01H1234567890ABCDEF&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;schema_version&quot;</span><span class="hl-2">: </span><span class="hl-9">1</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;event_type&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;created&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;producer&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;myapp&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;resource_type&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;user&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;resource_id&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;01H1234567890ABCDEF&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;occurred_at&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;2025-08-13T21:00:00Z&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;trace_id&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;abc123&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-11">&quot;payload&quot;</span><span class="hl-2">: { </span><span class="hl-11">&quot;id&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;01H...&quot;</span><span class="hl-2">, </span><span class="hl-11">&quot;name&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;Ada&quot;</span><span class="hl-2"> }</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üß®-dead-letter-queue-dlq" class="tsd-anchor-link">üß® Dead-Letter Queue (DLQ)<a href="#üß®-dead-letter-queue-dlq" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>When enabled, messages that exceed <code>maxDeliver</code> are moved to the DLQ subject:
<strong><code>{env}.events.dlq</code></strong></p>
<hr>
<h2 id="üß™-testing" class="tsd-anchor-link">üß™ Testing<a href="#üß™-testing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-5">describe</span><span class="hl-2">(</span><span class="hl-4">&#39;UserSubscriber&#39;</span><span class="hl-2">, () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">it</span><span class="hl-2">(</span><span class="hl-4">&#39;processes user events&#39;</span><span class="hl-2">, </span><span class="hl-6">async</span><span class="hl-2"> () </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">subscriber</span><span class="hl-2"> = </span><span class="hl-6">new</span><span class="hl-2"> </span><span class="hl-5">UserActivitySubscriber</span><span class="hl-2">();</span><br/><span class="hl-2">    </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">event</span><span class="hl-2"> = { </span><span class="hl-3">id:</span><span class="hl-2"> </span><span class="hl-4">&#39;123&#39;</span><span class="hl-2">, </span><span class="hl-3">name:</span><span class="hl-2"> </span><span class="hl-4">&#39;Alice&#39;</span><span class="hl-2"> };</span><br/><span class="hl-2">    </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">metadata</span><span class="hl-2"> = {</span><br/><span class="hl-2">      </span><span class="hl-3">event_id:</span><span class="hl-2"> </span><span class="hl-4">&#39;test-id&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-3">subject:</span><span class="hl-2"> </span><span class="hl-4">&#39;production.events.users.user.created&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-3">domain:</span><span class="hl-2"> </span><span class="hl-4">&#39;users&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-3">resource:</span><span class="hl-2"> </span><span class="hl-4">&#39;user&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-3">action:</span><span class="hl-2"> </span><span class="hl-4">&#39;created&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    };</span><br/><br/><span class="hl-2">    </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">subscriber</span><span class="hl-2">.</span><span class="hl-5">call</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">, </span><span class="hl-3">metadata</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-0">// Add your assertions here</span><br/><span class="hl-2">  });</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üîó-integration-with-express" class="tsd-anchor-link">üîó Integration with Express<a href="#üîó-integration-with-express" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">express</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;express&#39;</span><span class="hl-2">;</span><br/><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;nats-pubsub&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">app</span><span class="hl-2"> = </span><span class="hl-5">express</span><span class="hl-2">();</span><br/><span class="hl-3">app</span><span class="hl-2">.</span><span class="hl-5">use</span><span class="hl-2">(</span><span class="hl-3">express</span><span class="hl-2">.</span><span class="hl-5">json</span><span class="hl-2">());</span><br/><br/><span class="hl-3">app</span><span class="hl-2">.</span><span class="hl-5">post</span><span class="hl-2">(</span><span class="hl-4">&#39;/users&#39;</span><span class="hl-2">, </span><span class="hl-6">async</span><span class="hl-2"> (</span><span class="hl-3">req</span><span class="hl-2">, </span><span class="hl-3">res</span><span class="hl-2">) </span><span class="hl-6">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">const</span><span class="hl-2"> </span><span class="hl-8">user</span><span class="hl-2"> = </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-5">createUser</span><span class="hl-2">(</span><span class="hl-3">req</span><span class="hl-2">.</span><span class="hl-3">body</span><span class="hl-2">);</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Publish event</span><br/><span class="hl-2">  </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">publish</span><span class="hl-2">(</span><span class="hl-4">&#39;users&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;user&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;created&#39;</span><span class="hl-2">, {</span><br/><span class="hl-2">    </span><span class="hl-3">id:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">id</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">name:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">name</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-3">email:</span><span class="hl-2"> </span><span class="hl-3">user</span><span class="hl-2">.</span><span class="hl-3">email</span><span class="hl-2">,</span><br/><span class="hl-2">  });</span><br/><br/><span class="hl-2">  </span><span class="hl-3">res</span><span class="hl-2">.</span><span class="hl-5">json</span><span class="hl-2">(</span><span class="hl-3">user</span><span class="hl-2">);</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-3">app</span><span class="hl-2">.</span><span class="hl-5">listen</span><span class="hl-2">(</span><span class="hl-9">3000</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="deployment" class="tsd-anchor-link">Deployment<a href="#deployment" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="production-checklist" class="tsd-anchor-link">Production Checklist<a href="#production-checklist" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>[ ] Use TLS for NATS connections (<code>nats://</code> ‚Üí <code>tls://</code>)</li>
<li>[ ] Enable authentication on NATS server</li>
<li>[ ] Set appropriate <code>NODE_ENV=production</code></li>
<li>[ ] Configure proper logging levels</li>
<li>[ ] Set up monitoring and alerting</li>
<li>[ ] Use process manager (PM2, systemd)</li>
<li>[ ] Configure graceful shutdown handling</li>
<li>[ ] Set resource limits (memory, CPU)</li>
<li>[ ] Enable health checks</li>
<li>[ ] Review and tune <code>concurrency</code>, <code>maxDeliver</code>, <code>ackWait</code></li>
</ul>
<h3 id="process-manager-pm2" class="tsd-anchor-link">Process Manager (PM2)<a href="#process-manager-pm2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-5">pnpm</span><span class="hl-2"> </span><span class="hl-4">add</span><span class="hl-2"> </span><span class="hl-6">-g</span><span class="hl-2"> </span><span class="hl-4">pm2</span><br/><br/><span class="hl-0"># Start application</span><br/><span class="hl-5">pm2</span><span class="hl-2"> </span><span class="hl-4">start</span><span class="hl-2"> </span><span class="hl-4">dist/index.js</span><span class="hl-2"> </span><span class="hl-6">--name</span><span class="hl-2"> </span><span class="hl-4">nats-subscriber</span><br/><br/><span class="hl-0"># Configure for production</span><br/><span class="hl-5">pm2</span><span class="hl-2"> </span><span class="hl-4">startup</span><br/><span class="hl-5">pm2</span><span class="hl-2"> </span><span class="hl-4">save</span><br/><br/><span class="hl-0"># Monitor</span><br/><span class="hl-5">pm2</span><span class="hl-2"> </span><span class="hl-4">monit</span><br/><span class="hl-5">pm2</span><span class="hl-2"> </span><span class="hl-4">logs</span><span class="hl-2"> </span><span class="hl-4">nats-subscriber</span>
</code><button type="button">Copy</button></pre>

<h3 id="systemd-service" class="tsd-anchor-link">Systemd Service<a href="#systemd-service" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Create <code>/etc/systemd/system/nats-subscriber.service</code>:</p>
<pre><code class="ini">[Unit]
Description=NATS PubSub Subscriber
After=network.target

[Service]
Type=simple
User=nodejs
WorkingDirectory=/app
Environment=NODE_ENV=production
ExecStart=/usr/bin/node dist/index.js
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
</code><button type="button">Copy</button></pre>

<p>Enable and start:</p>
<pre><code class="bash"><span class="hl-5">sudo</span><span class="hl-2"> </span><span class="hl-4">systemctl</span><span class="hl-2"> </span><span class="hl-4">enable</span><span class="hl-2"> </span><span class="hl-4">nats-subscriber</span><br/><span class="hl-5">sudo</span><span class="hl-2"> </span><span class="hl-4">systemctl</span><span class="hl-2"> </span><span class="hl-4">start</span><span class="hl-2"> </span><span class="hl-4">nats-subscriber</span><br/><span class="hl-5">sudo</span><span class="hl-2"> </span><span class="hl-4">systemctl</span><span class="hl-2"> </span><span class="hl-4">status</span><span class="hl-2"> </span><span class="hl-4">nats-subscriber</span>
</code><button type="button">Copy</button></pre>

<h3 id="environment-specific-configuration" class="tsd-anchor-link">Environment-Specific Configuration<a href="#environment-specific-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Use environment variables or configuration files per environment:</p>
<pre><code class="typescript"><span class="hl-0">// config/production.ts</span><br/><span class="hl-1">export</span><span class="hl-2"> </span><span class="hl-1">default</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-3">natsUrls:</span><span class="hl-2"> </span><span class="hl-3">process</span><span class="hl-2">.</span><span class="hl-3">env</span><span class="hl-2">.</span><span class="hl-8">NATS_URLS</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">env:</span><span class="hl-2"> </span><span class="hl-4">&#39;production&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">appName:</span><span class="hl-2"> </span><span class="hl-4">&#39;my-app-prod&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">concurrency:</span><span class="hl-2"> </span><span class="hl-9">20</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">maxDeliver:</span><span class="hl-2"> </span><span class="hl-9">5</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">useDlq:</span><span class="hl-2"> </span><span class="hl-6">true</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">logger:</span><span class="hl-2"> </span><span class="hl-3">productionLogger</span><span class="hl-2">,</span><br/><span class="hl-2">};</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="troubleshooting" class="tsd-anchor-link">Troubleshooting<a href="#troubleshooting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="connection-issues" class="tsd-anchor-link">Connection Issues<a href="#connection-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Problem</strong>: Cannot connect to NATS server</p>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Verify NATS server is running: <code>nats-server -js</code></li>
<li>Check <code>NATS_URLS</code> configuration</li>
<li>Ensure JetStream is enabled on NATS server</li>
<li>Check firewall rules and network connectivity</li>
<li>Verify TLS certificates if using secure connections</li>
</ul>
<h3 id="no-messages-received" class="tsd-anchor-link">No Messages Received<a href="#no-messages-received" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Problem</strong>: Subscriber not receiving messages</p>
<p><strong>Solutions</strong>:</p>
<ul>
<li>
<p>Verify environment matches between publisher and subscriber</p>
</li>
<li>
<p>Check subject patterns match</p>
</li>
<li>
<p>Ensure subscriber is registered before calling <code>start()</code></p>
</li>
<li>
<p>Check NATS server logs for errors</p>
</li>
<li>
<p>Verify stream and consumer exist:</p>
<pre><code class="bash"><span class="hl-5">nats</span><span class="hl-2"> </span><span class="hl-4">stream</span><span class="hl-2"> </span><span class="hl-4">ls</span><br/><span class="hl-5">nats</span><span class="hl-2"> </span><span class="hl-4">stream</span><span class="hl-2"> </span><span class="hl-4">info</span><span class="hl-2"> &lt;</span><span class="hl-4">stream-nam</span><span class="hl-2">e&gt;</span><br/><span class="hl-5">nats</span><span class="hl-2"> </span><span class="hl-4">consumer</span><span class="hl-2"> </span><span class="hl-4">ls</span><span class="hl-2"> &lt;</span><span class="hl-4">stream-nam</span><span class="hl-2">e&gt;</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
<h3 id="memory-leaks" class="tsd-anchor-link">Memory Leaks<a href="#memory-leaks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Problem</strong>: Application memory usage grows over time</p>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Review custom middleware for resource cleanup</li>
<li>Check for unhandled promise rejections</li>
<li>Monitor event loop lag</li>
<li>Use <code>--max-old-space-size</code> flag if needed</li>
<li>Profile with Node.js profiling tools</li>
</ul>
<h3 id="high-cpu-usage" class="tsd-anchor-link">High CPU Usage<a href="#high-cpu-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Problem</strong>: CPU usage is higher than expected</p>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Reduce <code>concurrency</code> setting</li>
<li>Review subscriber logic for expensive operations</li>
<li>Add caching where appropriate</li>
<li>Consider scaling horizontally instead</li>
<li>Profile with <code>node --inspect</code></li>
</ul>
<h3 id="messages-going-to-dlq" class="tsd-anchor-link">Messages Going to DLQ<a href="#messages-going-to-dlq" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Problem</strong>: Too many messages ending up in Dead Letter Queue</p>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Review subscriber error logs</li>
<li>Increase <code>ackWait</code> if processing takes longer</li>
<li>Increase <code>maxDeliver</code> if appropriate</li>
<li>Fix bugs in subscriber logic</li>
<li>Add better error handling and logging</li>
<li>Check for external service timeouts</li>
</ul>
<h3 id="typescript-errors" class="tsd-anchor-link">TypeScript Errors<a href="#typescript-errors" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Problem</strong>: TypeScript compilation errors</p>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Ensure TypeScript version compatibility</li>
<li>Check <code>tsconfig.json</code> configuration</li>
<li>Verify all type definitions are installed</li>
<li>Run <code>pnpm add -D @types/node</code></li>
</ul>
<hr>
<h2 id="performance-tuning" class="tsd-anchor-link">Performance Tuning<a href="#performance-tuning" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="concurrency" class="tsd-anchor-link">Concurrency<a href="#concurrency" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Adjust based on your workload:</p>
<pre><code class="typescript"><span class="hl-3">NatsPubsub</span><span class="hl-2">.</span><span class="hl-5">configure</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-3">concurrency:</span><span class="hl-2"> </span><span class="hl-9">20</span><span class="hl-2">, </span><span class="hl-0">// Higher for I/O-bound tasks</span><br/><span class="hl-2">  </span><span class="hl-0">// concurrency: 5, // Lower for CPU-bound tasks</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<h3 id="batch-processing" class="tsd-anchor-link">Batch Processing<a href="#batch-processing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For high-throughput scenarios, consider batching:</p>
<pre><code class="typescript"><span class="hl-6">class</span><span class="hl-2"> </span><span class="hl-7">BatchProcessor</span><span class="hl-2"> </span><span class="hl-6">extends</span><span class="hl-2"> </span><span class="hl-7">BaseSubscriber</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">private</span><span class="hl-2"> </span><span class="hl-3">batch</span><span class="hl-2">: </span><span class="hl-7">any</span><span class="hl-2">[] = [];</span><br/><span class="hl-2">  </span><span class="hl-6">private</span><span class="hl-2"> </span><span class="hl-3">batchSize</span><span class="hl-2"> = </span><span class="hl-9">100</span><span class="hl-2">;</span><br/><br/><span class="hl-2">  </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">call</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">: </span><span class="hl-7">Record</span><span class="hl-2">&lt;</span><span class="hl-7">string</span><span class="hl-2">, </span><span class="hl-7">unknown</span><span class="hl-2">&gt;, </span><span class="hl-3">metadata</span><span class="hl-2">: </span><span class="hl-7">EventMetadata</span><span class="hl-2">): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-3">batch</span><span class="hl-2">.</span><span class="hl-5">push</span><span class="hl-2">(</span><span class="hl-3">event</span><span class="hl-2">);</span><br/><br/><span class="hl-2">    </span><span class="hl-1">if</span><span class="hl-2"> (</span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-3">batch</span><span class="hl-2">.</span><span class="hl-3">length</span><span class="hl-2"> &gt;= </span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-3">batchSize</span><span class="hl-2">) {</span><br/><span class="hl-2">      </span><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-5">processBatch</span><span class="hl-2">(</span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-3">batch</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-6">this</span><span class="hl-2">.</span><span class="hl-3">batch</span><span class="hl-2"> = [];</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-2">  </span><span class="hl-6">private</span><span class="hl-2"> </span><span class="hl-6">async</span><span class="hl-2"> </span><span class="hl-5">processBatch</span><span class="hl-2">(</span><span class="hl-3">events</span><span class="hl-2">: </span><span class="hl-7">any</span><span class="hl-2">[]): </span><span class="hl-7">Promise</span><span class="hl-2">&lt;</span><span class="hl-7">void</span><span class="hl-2">&gt; {</span><br/><span class="hl-2">    </span><span class="hl-0">// Process multiple events at once</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<h2 id="üìÑ-license" class="tsd-anchor-link">üìÑ License<a href="#üìÑ-license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><a href="media/LICENSE">MIT License</a></p>
<h2 id="contributing" class="tsd-anchor-link">Contributing<a href="#contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>See <a href="media/CONTRIBUTING.md">CONTRIBUTING.md</a> for contribution guidelines.</p>
<h2 id="support" class="tsd-anchor-link">Support<a href="#support" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>GitHub Issues: <a href="https://github.com/attaradev/nats_pubsub/issues">https://github.com/attaradev/nats_pubsub/issues</a></li>
<li>Email: <a href="mailto:mpyebattara@gmail.com">mpyebattara@gmail.com</a></li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#natspubsub-nodejstypescript"><span>Nats<wbr/>Pubsub (<wbr/>Node.js/<wbr/>Type<wbr/>Script)</span></a><ul><li><a href="#üöÄ-quick-start-5-minutes"><span>üöÄ <wbr/>Quick <wbr/>Start (&lt; 5 minutes)</span></a></li><li><a href="#table-of-contents"><span>Table of <wbr/>Contents</span></a></li><li><a href="#‚ú®-features"><span>‚ú® <wbr/>Features</span></a></li><li><a href="#üì¶-install"><span>üì¶ <wbr/>Install</span></a></li><li><ul><li><a href="#prerequisites"><span>Prerequisites</span></a></li><li><a href="#start-nats-server"><span>Start <wbr/>NATS <wbr/>Server</span></a></li></ul></li><li><a href="#üîß-configure"><span>üîß <wbr/>Configure</span></a></li><li><ul><li><a href="#environment-variables"><span>Environment <wbr/>Variables</span></a></li></ul></li><li><a href="#üì°-subject-patterns"><span>üì° <wbr/>Subject <wbr/>Patterns</span></a></li><li><ul><li><a href="#topic-based-pattern"><span>Topic-<wbr/>Based <wbr/>Pattern</span></a></li><li><a href="#domainresourceaction-pattern"><span>Domain/<wbr/>Resource/<wbr/>Action <wbr/>Pattern</span></a></li></ul></li><li><a href="#üéØ-declarative-subscribers"><span>üéØ <wbr/>Declarative <wbr/>Subscribers</span></a></li><li><ul><li><a href="#using-class-based-approach"><span>Using <wbr/>Class-<wbr/>based <wbr/>Approach</span></a></li><li><a href="#using-decorator-experimental"><span>Using <wbr/>Decorator (experimental)</span></a></li><li><a href="#multiple-subjects"><span>Multiple <wbr/>Subjects</span></a></li></ul></li><li><a href="#üì§-publish-events"><span>üì§ <wbr/>Publish <wbr/>Events</span></a></li><li><ul><li><a href="#topic-based-publishing"><span>Topic-<wbr/>Based <wbr/>Publishing</span></a></li><li><a href="#domainresourceaction-publishing"><span>Domain/<wbr/>Resource/<wbr/>Action <wbr/>Publishing</span></a></li><li><a href="#with-options"><span>With <wbr/>Options</span></a></li></ul></li><li><a href="#üöÄ-run-subscribers"><span>üöÄ <wbr/>Run <wbr/>Subscribers</span></a></li><li><a href="#üé≠-middleware"><span>üé≠ <wbr/>Middleware</span></a></li><li><a href="#üì¨-envelope-format"><span>üì¨ <wbr/>Envelope <wbr/>Format</span></a></li><li><a href="#üß®-dead-letter-queue-dlq"><span>üß® <wbr/>Dead-<wbr/>Letter <wbr/>Queue (<wbr/>DLQ)</span></a></li><li><a href="#üß™-testing"><span>üß™ <wbr/>Testing</span></a></li><li><a href="#üîó-integration-with-express"><span>üîó <wbr/>Integration with <wbr/>Express</span></a></li><li><a href="#deployment"><span>Deployment</span></a></li><li><ul><li><a href="#production-checklist"><span>Production <wbr/>Checklist</span></a></li><li><a href="#process-manager-pm2"><span>Process <wbr/>Manager (<wbr/>PM2)</span></a></li><li><a href="#systemd-service"><span>Systemd <wbr/>Service</span></a></li><li><a href="#environment-specific-configuration"><span>Environment-<wbr/>Specific <wbr/>Configuration</span></a></li></ul></li><li><a href="#troubleshooting"><span>Troubleshooting</span></a></li><li><ul><li><a href="#connection-issues"><span>Connection <wbr/>Issues</span></a></li><li><a href="#no-messages-received"><span>No <wbr/>Messages <wbr/>Received</span></a></li><li><a href="#memory-leaks"><span>Memory <wbr/>Leaks</span></a></li><li><a href="#high-cpu-usage"><span>High <wbr/>CPU <wbr/>Usage</span></a></li><li><a href="#messages-going-to-dlq"><span>Messages <wbr/>Going to <wbr/>DLQ</span></a></li><li><a href="#typescript-errors"><span>Type<wbr/>Script <wbr/>Errors</span></a></li></ul></li><li><a href="#performance-tuning"><span>Performance <wbr/>Tuning</span></a></li><li><ul><li><a href="#concurrency"><span>Concurrency</span></a></li><li><a href="#batch-processing"><span>Batch <wbr/>Processing</span></a></li></ul></li><li><a href="#üìÑ-license"><span>üìÑ <wbr/>License</span></a></li><li><a href="#contributing"><span>Contributing</span></a></li><li><a href="#support"><span>Support</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">nats-pubsub API Documentation - v0.2.0</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
